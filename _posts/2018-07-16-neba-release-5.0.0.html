---
title: NEBA 5.0.0 released
layout: post
twitterAuthor: deploynix
description: NEBA 5.0.0 introduces a flyweight kernel, an optional Spring 5 integration and ships with a vast number of improvements.
---

<section>
    <header><h1>NEBA 5.0.0 released</h1></header>
    <p>
        With 5.0.0, NEBA introduces a flyweight core and becomes independent of the Spring Framework. The Spring integration, albeit optional, is now available as a dedicated module and is upgraded to Spring 5.
        At the same time, the API has been partially restructured and simplified.
    </p>
</section>


<section>
    <header><h2>Contents</h2></header>
    <ul>
        <li><a href="#highlights">Highlights of this release</a></li>
        <li><a href="#releasenotes">Release notes</a></li>
        <li><a href="#compatibility">Supported AEM and Java Versions</a></li>
        <li><a href="#upgrading">Upgrading from NEBA 4.3.x</a></li>
    </ul>
</section>

<section>
    <header><h2 id="highlights">Highlights of this release</h2></header>
    <section>
        <header><h3>NEBA 5.0.0 becomes independent of the Spring Framework</h3></header>
        <p>
           The recent versions of AEM have seen a growing ecosystem of production-quality open source solutions, e.g. <a href="https://github.com/Adobe-Consulting-Services/acs-aem-commons">ACS commons</a> or
            <a href="https://sling.apache.org/documentation/bundles/models.html">Sling models</a> which form a solid foundation for many projects. Likewise, the trade-of between the footprint of the Spring integration
            and the features gained by the integration became smaller.
        </p>
        <p>
            Here, we choose to provide NEBA's core functionality with two lightweight bundles and make the Spring integration optional. Without using Spring, all it takes is a model annotated with <a href="/apidocs/neba-api/io/neba/api/annotations/RceModel.html">@ResourceModel</a> and the <a href="/documentation.html#add_neba_packages_header">OSGi bundle header
            <code>Neba-Packages</code></a> to point to the respective package.
        </p>
        <p>
            If you want to continue using the Spring Framework, rest easy: You can
            still deploy NEBA and the Spring integration with <a href="/download.html#spring-integration">one simple CRX package or delivery bundle</a>.
        </p>
    </section>
    <section>
        <header><h3>Cleaner, simpler API</h3></header>
        <p>
            NEBA's API is now even more consise: A dedicated <em>SPI</em> (Service Provider Interface) package contains all extensions points in the form of service interfaces.
            The <em>services</em> package, on the other hand, contains interfaces of services published by NEBA. The <em>annotations</em> package remains largely unchanged and continues
            to provide NEBA's core functionality via semantic annotations. The notable exception is the <code>@PostMapping</code> annotation, which has been renamed to <a href="/apidocs/neba-api/io/neba/api/annotations/AfterMapping.html">@AfterMapping</a> - both for clarity and to
            avoid using the same name as Spring's REST annotation for HTTP POST MVC mappings.
            Release 5.0.0 also introduces the <a href="/apidocs/neba-api/io/neba/api/annotations/Filter.html">@Filter</a> annotation, which allows filtering OSGi services injected into resource models.
        </p>
    </section>
    <section>
        <header><h3>Even Faster</h3></header>
        <p>
            Performance and scalability have always been a key design goal of NEBA, as it is used in many large-scale Content Management deployments. With 5.0.0, NEBA ships a lightning-fast factory for models
            not managed in a Spring Application Context.
        </p>
    </section>
    <section>
        <header><h3>Update to Spring 5</h3></header>
        <p>
            The NEBA Spring integration is upgraded to Spring 5, the current GA version of the <a href="https://spring.io/projects/spring-framework">Spring Framework</a> (<a href="https://jira.spring.io/jira/secure/ReleaseNote.jspa?projectId=10000&version=16753">release notes</a>).
            This includes an upgrade to <a href="https://www.eclipse.org/gemini/blueprint/">Gemini Blueprint 3.0.0</a> (<a href="http://git.eclipse.org/c/gemini.blueprint/org.eclipse.gemini.blueprint.git/plain/changelog.txt?h=3.0.0.M01">release notes</a>).
        </p>
    </section>
    <section>
        <header><h3>Simple rules for dependency injection and content mapping</h3></header>
        <p>
            NEBA follows a simple rule: <code>@Inject</code> is for OSGi services, NEBA annotations are for content mapping. Of course, users of NEBA's Spring module can continue leveraging all
            capabilities of the Application context to inject their models.
        </p>
    </section>
    <section>
        <header><h3>Revised documentation</h3></header>
        <p>
            Along with the 5.0.0 release, NEBA also release a new website that adheres to the same principles as NEBA: Simplicity and performance. For this release, the <a href="/documentation.html">Documentation</a>
            has been restructured, revised and extensively updated.
        </p>
    </section>
</section>

<section>
    <header>
        <h2 id="compatibility">Supported AEM and Java Versions</h2>
    </header>
    <p>
        NEBA 5.0.0 supports AEM 6.2, 6.3 and 6.4 as well as the Sling versions packaged as <a href="http://sling.apache.org/downloads.cgi">Sling App 9 and 10</a> and runs on both Oracle and OpenJDK 8.
    </p>
</section>

<section>
    <header><h2 id="releasenotes">Release notes</h2></header>

    <section>
        <header><h3>Improvements</h3></header>
        <ul class="issue-list" data-milestone="21" data-labels="enhancement"></ul>
    </section>

    <section>
        <header><h3>Fixed bugs</h3></header>
        <ul class="issue-list" data-milestone="21" data-labels="bug"></ul>
    </section>
</section>
    <section>

        <header><h2 id="upgrading">Upgrading from 4.3.x</h2></header>
        <p>
            Users of 4.3.x need to follow the following steps to upgrade their application.
        </p>
        <section>
            <header><h3>Neba core and Neba Spring</h3></header>
            <p>
                NEBA 5.0.0 now offers a choice between just using the flyweight neba core or using the neba core along with the neba spring integration.
                If you are heavily relying on <a href="/documentation.html#spring_mvc">NEBA's Spring MVC integration</a>, you might want to continue using NEBA with Spring.
                In this case, simply <a href="/download.html#spring-integration">use the NEBA delivery package containing the Spring integration</a> and continue using NEBA as before.
            </p>
            <p>
                However, if you are mainly using resource models or only a few MVC features, consider switching to just using NEBA core. In this case, Spring @Service beans should become OSGi Services (e.g. using the <code>@Component</code> annotation) and
                resource models should use @Inject and, if necessary, <a href="/documentation.html#the_filter_annotation">the @Filter annotation</a> to wire these service dependencies.
            </p>
            <div class="up-to-two-columns">
                <section>
                    <header><h4>A Spring-Bean based Resource Model</h4></header>
<figure class="listing" id="listing:spring-based-model">
{% highlight java %}
import io.neba.api.annotations.ResourceModel;
import org.springframework.stereotype.Component;
import org.springframework.context.annotation.Scope;
import org.eclipse.gemini.blueprint.extensions.annotation.ServiceReference;

@Component //Required for Spring's class path scanning
@Scope("prototype") //Resource models must have prototype scope
@ResourceModel(types = "myproject/components/myComponent")
public class MyModel {
    @ServiceReference(filter="(some=filter)") //Provided by the gemini-blueprint-extensions bundle.
    private Service service;
}
{% endhighlight %}
<figcaption>A Spring-based Resource Model</figcaption>
</figure>

                    <p>The bundle containing this model must of course contain a <a href="/documentation.html#spring">Blueprint application context definition</a> to create the respective Spring Application Context.</p>

                </section>
                <section>
                    <header><h4>A Resource model without Spring</h4></header>

<figure class="listing" id="listing:sample-content">
{% highlight java %}
package my.bundle.namespace;

import io.neba.api.annotations.ResourceModel;

@ResourceModel(types = "myproject/components/myComponent")
public class MyModel {
    @Inject // @Inject is for OSGi Services
    @Filter("(some=filter)")
    private Service service;
}
{% endhighlight %}
<figcaption>A NEBA resource model without Spring</figcaption>
</figure>
                    <p>Here, the package <code>my.bundle.namespace</code> would need to be <a href="/documentation.html#add_neba_packages_header">in the Neba-Packages bundle header</a>.</p>

                </section>
            </div>
        </section>
        <section>
            <header><h3>Upgrade to Spring 5</h3></header>
            <p>
                NEBA 5.0.0 ships with Spring 5.0.x. If you choose to continue using Spring, you must update the <a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.apache.servicemix.bundles%22%20AND%20a%3Aorg.apache.servicemix.bundles.spring-*%20AND%20v%3A%225.0.7.RELEASE_1%22">Spring dependencies</a> accordingly.
            </p>
        </section>
        <section>
            <header><h3>Remove usages of @PreMapping, change usages of @PostMapping to @AfterMapping</h3></header>
            <p>
                In 5.0.0, the <code>@PreMapping</code> annotation has been removed. If you require this rare use case, consider introducing a <a href="/documentation.html#custom_annotations">Custom annotation</a> instead.
                The <code>@PostMapping</code> annotation has been renamed to <a href="/apidocs/neba-api/io/neba/api/annotations/AfterMapping.html">@AfterMapping</a>, usages must be updated accordingly.
            </p>
        </section>
        <section>
            <header><h3>io.neba.api.resourcemodels.Optional is removed and replaced with io.neba.api.resourcemodels.Lazy</h3></header>
            <p>
                In 5.0.0, NEBA's deprecated <code>Optional</code> interface for lazy-loading 1:1 relationships has been removed. Users of NEBA's <code>Optional</code> interface must use <a href="/documentation.html#the_lazy_interface">Lazy</a> instead.
            </p>
        </section>
        <section>
            <header><h3>Package change for Service Provider Interfaces such as AnnotatedFieldMapper or ResourceModelPostProcessor</h3></header>
            <p>
                NEBA extension points are now situated in the dedicated <a href="/apidocs/neba-api/io/neba/api/spi/package-summary.html">io.neba.api.spi package</a>.
            </p>
        </section>
    </section>
